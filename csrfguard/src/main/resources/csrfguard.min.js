(()=>{const e='%UNPROTECTED_EXTENSIONS%',t='%TOKENS_PER_PAGE%',n='%INJECT_XHR%';var s=s||{};!0!==s&&function(){function o(e,t,n){e.addEventListener?(e.addEventListener(t,n,!1),a.add(e,t,n)):e.attachEvent?(e['e'+t+n]=n,e[t+n]=function(){e['e'+t+n](window.event)},e.attachEvent('on'+t,e[t+n]),a.add(e,t,n)):e['on'+t]=e['e'+t+n]}s=!0;var r,a={listEvents:r=[],add:function(e,t,n){r.push(arguments)},flush:function(){var e,t;for(e=r.length-1;e>=0;e-=1)(t=r[e])[0].removeEventListener&&t[0].removeEventListener(t[1],t[2],t[3]),'on'!==t[1].substring(0,2)&&(t[1]='on'+t[1]),t[0].detachEvent&&t[0].detachEvent(t[1],t[2])}};function i(e,t){return 0===e.indexOf(t)}function u(e,t){return e.substring(e.length-t.length)===t}function l(e,t){var n=!1;if(t&&t.constructor===Array){for(var s=0;s<t.length;s++)if(l(e,t[s]))return!0;return!1}return e===t&&(n=!0),n}function c(e){var t=!1;if('http://'===e.substring(0,7)||'https://'===e.substring(0,8)){for(var n=e.indexOf('://'),s=e.substring(n+3),o='',r=0;r<s.length;r++){var a=s.charAt(r);if('/'===a||':'===a||'#'===a)break;o+=a}t=l(location.hostname,o)}else'#'===e.charAt(0)?t=!1:i(e,'//')||'/'!==e.charAt(0)&&-1!==e.search(/^[a-zA-Z][a-zA-Z0-9.+-]*:/)||(t=!0);return t}function p(e){var t='',n=e.indexOf('://'),s='';s=n>0?e.substring(n+3):'/'!==e.charAt(0)?'%CONTEXT_PATH%/'+e:e;for(var o=-1===n,r=0;r<s.length;r++){var a=s.charAt(r);if('/'===a)o=!0;else if(!0===o&&('?'===a||'#'===a)){o=!1;break}!0===o&&(t+=a)}return t}function d(e,t){let n=null;return Object.keys(e).forEach((function(s){var o=e[s];t===s?n=o:i(s,'^')&&u(s,'$')?new RegExp(s).test(t)&&(n=o):i(s,'/*')?n=o:u(s,'/*')||i(s,'.*')})),n}function f(e,t,n,s,o){if(!o){var r=e.getAttribute('method');if(null!=r&&'get'===r.toLowerCase())return}var a=n,i=e.getAttribute('action');if(null!==i&&c(i)){const o=d(s,p(i));a=null==o?n:o;let r=Object.keys(e.elements).filter((function(n){return e.elements[n].name===t}));if(0===r.length){var u=document.createElement('input');u.setAttribute('type','hidden'),u.setAttribute('name',t),u.setAttribute('value',a),e.appendChild(u)}else r.forEach((function(t){return e.elements[t].value=a}))}}function h(t,n,s,o,r){const a=function(e,t,n){let s;return s=-1===e.indexOf('?')?e+'?'+t+'='+n:e+'&'+t+'='+n,s},i=t.getAttribute&&t.getAttribute(n);if(null!=i&&c(i)&&!function(t){var n=!1,s=e;if(''!==s)for(var o=function(e){var t='';-1!==e.indexOf(';')&&(e=e.split(';')[0]);-1!==e.indexOf('.')&&(t=e.substring(e.lastIndexOf('.')+1,e.length)||e);return t}(p(t)).toLowerCase(),r=s.split(','),a=0;a<r.length;a++)if(r[a]===o){n=!0;break}return n}(i)){const e=d(r,p(i)),u=null==e?o:e,l=new RegExp('(?:'+s+'=)([^?|#|&]+)','gi').exec(i);if(null===l||0===l.length){let e;const o=i.indexOf('#');if(-1!==o){const t=i.split('#')[0],n=i.substring(o);e=a(t,s,u)+n}else e=a(i,s,u);try{t.setAttribute(n,e)}catch(e){}}else{let e=i;l.slice(1).forEach((function(t){return e=e.replace(t,u)})),t.setAttribute(n,e)}}}function g(e,t,n,s){var o=e.length;for(let r=0;r<o;r++){let a=e[r];a.tagName&&'form'===a.tagName.toLowerCase()?(f(a,t,n,s,'%INJECT_GET_FORMS%'),o=e.length,h(a,'action',t,n,s)):(h(a,'src',t,n,s),h(a,'href',t,n,s))}}function y(e,n,s){var o={};t&&(o=s),g(document.all?document.all:document.getElementsByTagName('*'),e,n,o)}var E='%DOMAIN_ORIGIN%'.split(',');if(l(document.domain,E)){var v='%TOKEN_NAME%',b='%TOKEN_VALUE%',T={isDomContentLoaded:!1},w={pageTokens:{}};if(o(window,'pagehide',a.flush),o(window,'DOMContentLoaded',(function(){T.isDomContentLoaded=!0,w.pageTokensLoaded&&y(v,b,w.pageTokens)})),function(){const e='%DYNAMIC_NODE_CREATION_EVENT_NAME%';if(e)o(window,e,(function(e){g([e.detail],v,b,w.pageTokens)}));else if(MutationObserver){const e=new MutationObserver((function(e,t){for(let t in e){const n=e[t],s=n.addedNodes;'childList'===n.type&&s.length&&s.length>0&&g(s,v,b,w.pageTokens)}}));e.observe(document,{attributes:!1,childList:!0,subtree:!0}),o(window,'pagehide',e.disconnect)}else o(window,'DOMNodeInserted',(function(e){const t=e.target||e.srcElement;'DOMNodeInserted'===e.type&&g([t],v,b,w.pageTokens)}))}(),n&&('Microsoft Internet Explorer'===navigator.appName?function(){var e=window.XMLHttpRequest;function t(){this.base=e?new e:new window.ActiveXObject('Microsoft.XMLHTTP')}function n(){return new t}n.prototype=t.prototype,n.UNSENT=0,n.OPENED=1,n.HEADERS_RECEIVED=2,n.LOADING=3,n.DONE=4,n.prototype.status=0,n.prototype.statusText='',n.prototype.readyState=n.UNSENT,n.prototype.responseText='',n.prototype.responseXML=null,n.prototype.onsend=null,n.url=null,n.onreadystatechange=null,n.prototype.open=function(e,t,n,s,o){var r=this;this.url=t,this.base.onreadystatechange=function(){try{r.status=r.base.status}catch(e){}try{r.statusText=r.base.statusText}catch(e){}try{r.readyState=r.base.readyState}catch(e){}try{r.responseText=r.base.responseText}catch(e){}try{r.responseXML=r.base.responseXML}catch(e){}null!==r.onreadystatechange&&r.onreadystatechange.apply(this,arguments)},this.base.open(e,t,n,s,o)},n.prototype.send=function(e){null!==this.onsend&&this.onsend.apply(this,arguments),this.base.send(e)},n.prototype.abort=function(){this.base.abort()},n.prototype.getAllResponseHeaders=function(){return this.base.getAllResponseHeaders()},n.prototype.getResponseHeader=function(e){return this.base.getResponseHeader(e)},n.prototype.setRequestHeader=function(e,t){return this.base.setRequestHeader(e,t)},window.XMLHttpRequest=n}():(XMLHttpRequest.prototype._open=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(e,t,n,s,o){this.url=t,this._open.apply(this,arguments)},XMLHttpRequest.prototype._send=XMLHttpRequest.prototype.send,XMLHttpRequest.prototype.send=function(e){null!==this.onsend&&this.onsend.apply(this,arguments),this._send.apply(this,arguments)}),XMLHttpRequest.prototype.onsend=function(e){o(this,'readystatechange',(function(){if(4===this.readyState){let e=this.getResponseHeader(v);if(null!=e)try{let t=JSON.parse(e),n=t.masterToken;void 0!==n&&(b=n);let s=t.pageTokens;void 0!==s&&Object.keys(s).forEach((function(e){return w.pageTokens[e]=s[e]})),y(v,b,w.pageTokens)}catch(e){}}}));if(c(this.url)){this.setRequestHeader('X-Requested-With','XMLHttpRequest');let e=function(e){var t=function(e,t){let n=e.indexOf(t);return n>0?e.substring(0,n):e};let n=/^(?:https?:)?\/\/[^\/]*(\/[^#?]*)?.*/.exec(e),s=i(e=n?n[1]||'/':e,'/')?e:'/'+e;return s=t(s,'?'),s=t(s,'#'),s}(this.url);if(null===w.pageTokens)this.setRequestHeader(v,b);else{let t=d(w.pageTokens,e);if(null==t){let t=function(e,t){let n=null,s=window.location.pathname.substring(1).split('/'),o='';for(let r=0;r<s.length-1;r++){o+='/'+s[r];let a=d(e,o+t);if(null!=a){n=a;break}}return n}(w.pageTokens,e);null===t?this.setRequestHeader(v,b):this.setRequestHeader(v,t)}else this.setRequestHeader(v,t)}}}),t){!function(e,t,n){const s=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject('Microsoft.XMLHTTP');s.open('POST','%SERVLET_PATH%','%ASYNC_XHR%'),void 0!==e&&void 0!==t&&s.setRequestHeader(e,t),s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status){let e=JSON.parse(s.responseText).pageTokens;n.call(this,e)}else alert(s.status+': CSRF check failed')},s.send(null)}(v,b,(function(e){w.pageTokens=e,w.pageTokensLoaded=!0,T.isDomContentLoaded&&y(v,b,e)}))}else o(window,'DOMContentLoaded',(function(){y(v,b,{})}))}else alert('OWASP CSRFGuard JavaScript was included from within an unauthorized domain!')}()})();